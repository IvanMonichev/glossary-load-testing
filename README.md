# Glossary Load Testing

## –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑ docker-compose: 
```bash
docker compose up -d 
```
2. –ü–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ —Å–µ—Ä–≤–∏—Å—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∞–¥—Ä–µ—Å–∞–º:

- REST (FastAPI): http://localhost:4010/docs
- gRPC: port 50051
- Mongo Express: http://localhost:8082
- Locust (–Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ): http://localhost:8089

–°–µ—Ä–≤–∏—Å REST (FastAPI) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –∫–æ–ª–ª–µ–∫—Ü–∏—é –≤ MongoDB –∏ –ø—Ä–æ—Å–∏–¥–∏—Ä—É–µ—Ç –µ—ë —Ñ–µ–π–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.


## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã

### –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã —Ö–æ—Å—Ç–∞
- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: MacBook Air (M1)
- –û–°: macOS 15.7.2 (24G325)
- –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: Apple M1 (8-—è–¥–µ—Ä–Ω—ã–π, ARM)
- –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å: 16 GB 
- –°–µ—Ç—å: –ª–æ–∫–∞–ª—å–Ω–∞—è docker-—Å–µ—Ç—å (bridge), –Ω–∞–≥—Ä—É–∑–∫–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ docker-compose —Å—Ç–µ–Ω–¥–∞ 
- Docker: –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å—Ç–µ–Ω–¥–∞
–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã –≤ Docker Compose –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –æ–±—â–µ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏. –°—Ç–µ–Ω–¥ –≤–∫–ª—é—á–∞–µ—Ç:
- MongoDB ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤–∞—Ä—è
- Mongo Express ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
- FastAPI REST —Å–µ—Ä–≤–∏—Å ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è API —á–µ—Ä–µ–∑ HTTP/JSON
- gRPC —Å–µ—Ä–≤–∏—Å ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è API —á–µ—Ä–µ–∑ protobuf RPC
- Locust ‚Äî –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞–≥—Ä—É–∑–∫–∏ (web UI + worker)

Locust 2.34.0. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏ –∫–∞–∫ –¥–ª—è REST, —Ç–∞–∫ –∏ –¥–ª—è gRPC, —Å —Ä—É—á–Ω—ã–º –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º RPC-–≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ events.request.fire().

## –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –õ–æ–≥–∏–∫–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (tasks flow)
–û–±–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∫–ª–∞—Å—Å–∞ (REST –∏ gRPC):
- –≤—ã–ø–æ–ª–Ω—è—é—Ç –±—ã—Å—Ç—Ä—ã–π –∑–∞–ø—Ä–æ—Å GetTerm (–ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞ –ø–æ ID) ‚Äî 70% –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π; 
- –≤—ã–ø–æ–ª–Ω—è—é—Ç –±–æ–ª–µ–µ —Ç—è–∂—ë–ª—ã–π –∑–∞–ø—Ä–æ—Å SearchTerms (–ø–æ–∏—Å–∫ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ) ‚Äî 30% –æ–ø–µ—Ä–∞—Ü–∏–π; 
- –¥–µ–ª–∞—é—Ç –ø–∞—É–∑—É –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ 0.1‚Äì0.5 c; 
- –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: ID –∏–∑ –Ω–∞–±–æ—Ä–∞, query –∏–∑ —Å–ø–∏—Å–∫–∞.

### –§—Ä–∞–≥–º–µ–Ω—Ç—ã —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–¥–∞

```python
from locust import HttpUser, task, between
import random
from config import REST_HOST, TERM_IDS


class RestUser(HttpUser):
    wait_time = between(0.1, 0.5)
    host = REST_HOST

    @task(7)
    def get_term(self):
        term_id = random.choice(TERM_IDS)
        self.client.get(f"/terms/{term_id}", name="REST: GetTerm")

    @task(3)
    def search_terms(self):
        query = random.choice(["a", "e", "data", "tech"])
        page = random.randint(1, 5)

        self.client.get(
            f"/terms?query={query}&page={page}&page_size=20",
            name="REST: SearchTerms"
        )
```

```python
from locust import User, task, between, events
import grpc
import time
import random

import glossary_pb2
import glossary_pb2_grpc

from config import GRPC_HOST, TERM_IDS


class GrpcUser(User):
    wait_time = between(0.1, 0.5)

    def on_start(self):
        self.channel = grpc.insecure_channel(GRPC_HOST)
        self.stub = glossary_pb2_grpc.GlossaryServiceStub(self.channel)

    @task(7)
    def get_term(self):
        term_id = random.choice(TERM_IDS)
        req = glossary_pb2.GetTermRequest(id=term_id)

        start = time.time()
        success = True
        error_msg = ""

        try:
            self.stub.GetTerm(req)
        except Exception as e:
            success = False
            error_msg = str(e)

        total_time_ms = (time.time() - start) * 1000

        events.request.fire(
            request_type="gRPC",
            name="gRPC: GetTerm",
            response_time=total_time_ms,
            response_length=0,
            exception=None if success else error_msg
        )

    @task(3)
    def search_terms(self):
        req = glossary_pb2.SearchTermsRequest(
            query=random.choice(["a", "e", "tech", "data"]),
            page=random.randint(1, 5),
            page_size=20
        )

        start = time.time()
        success = True
        error_msg = ""

        try:
            self.stub.SearchTerms(req)
        except Exception as e:
            success = False
            error_msg = str(e)

        total_time_ms = (time.time() - start) * 1000

        events.request.fire(
            request_type="gRPC",
            name="gRPC: SearchTerms",
            response_time=total_time_ms,
            response_length=0,
            exception=None if success else error_msg
        )
```

### Sanity-—Ç–µ—Å—Ç (–ª—ë–≥–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞)
| –ü–∞—Ä–∞–º–µ—Ç—Ä     | –ó–Ω–∞—á–µ–Ω–∏–µ     |
| ------------ | ------------ |
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | **20**       |
| Spawn rate   | **5**        |
| –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | **1 –º–∏–Ω—É—Ç–∞** |

#### –ì–∏–ø–æ—Ç–µ–∑—ã:
- —Å–µ—Ä–≤–∏—Å—ã —Å—Ç–∞—Ä—Ç—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –æ—à–∏–±–æ–∫ –Ω–µ –±—É–¥–µ—Ç;
- –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–∞ (1‚Äì10 ms);
- –æ—Ç–ª–∏—á–∏–µ REST/gRPC –∑–∞–º–µ—Ç–Ω–æ, –Ω–æ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ;
- RPS —É–º–µ—Ä–µ–Ω–Ω—ã–π (100‚Äì200 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å).

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ú–µ—Ç—Ä–∏–∫–∞                       | REST           | gRPC           |
| ----------------------------- | -------------- | -------------- |
| **Requests per second (RPS)** | ~33.5          | ~33.5          |
| **Average latency**           | **7.2‚Äì8.4 ms** | **3.9‚Äì5.1 ms** |
| **Median (50%)**              | 6‚Äì8 ms         | 4‚Äì5 ms         |
| **p95**                       | 13‚Äì14 ms       | 6‚Äì8 ms         |
| **p99**                       | 18‚Äì19 ms       | 7‚Äì12 ms        |
| **–ú–∏–Ω–∏–º—É–º**                   | 4 ms           | 1‚Äì2 ms         |
| **–ú–∞–∫—Å–∏–º—É–º**                  | 40‚Äì95 ms       | 22‚Äì42 ms       |
| **–û—à–∏–±–∫–∏**                    | 0              | 0              |

#### –í—ã–≤–æ–¥—ã
–û–±–∞ —Å–µ—Ä–≤–∏—Å–∞ —É—Å–ø–µ—à–Ω–æ –≤—ã–¥–µ—Ä–∂–∞–ª–∏ –ª—ë–≥–∫—É—é –Ω–∞–≥—Ä—É–∑–∫—É: –æ—à–∏–±–æ–∫ –Ω–µ –≤–æ–∑–Ω–∏–∫–ª–æ, –∑–∞–¥–µ—Ä–∂–∫–∏ –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏, –∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å RPS –¥–ª—è REST –∏ gRPC –æ–∫–∞–∑–∞–ª—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º. –ü—Ä–∏ —ç—Ç–æ–º gRPC –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã: –º–µ–¥–∏–∞–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –æ–∫–∞–∑–∞–ª–∞—Å—å –Ω–∞ 40‚Äì55% –Ω–∏–∂–µ, –∞ –∑–Ω–∞—á–µ–Ω–∏—è p95 –∏ p99 ‚Äî –ø–æ—á—Ç–∏ –≤ –¥–≤–∞ —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ gRPC —Å–æ—Å—Ç–∞–≤–∏–ª–∞ –æ–∫–æ–ª–æ 1‚Äì2 –º—Å. –£ REST –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –µ–¥–∏–Ω–∏—á–Ω—ã–µ –≤—Å–ø–ª–µ—Å–∫–∏ –¥–æ 95 –º—Å, –æ–¥–Ω–∞–∫–æ –æ–Ω–∏ –Ω–µ –ø–æ–≤–ª–∏—è–ª–∏ –Ω–∞ –æ–±—â—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã. –ü–æ –∏—Ç–æ–≥–∞–º —Ç–µ—Å—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑–∞–ª–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –Ω–µ –Ω–∞–±–ª—é–¥–∞–ª–æ—Å—å, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Å–ª–µ–¥—É—é—â–∏–º –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–º —Å—Ü–µ–Ω–∞—Ä–∏—è–º.

üìÑ [HTML-–æ—Ç—á—ë—Ç Locust (sanity test)](reports/report-01.html)

### –†–∞–±–æ—á–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (–Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º)
| –ü–∞—Ä–∞–º–µ—Ç—Ä     | –ó–Ω–∞—á–µ–Ω–∏–µ    |
| ------------ | ----------- |
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | **200**     |
| Spawn rate   | **20**      |
| –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | **5 –º–∏–Ω—É—Ç** |

#### –ì–∏–ø–æ—Ç–µ–∑—ã:
- REST –Ω–∞—á–Ω—ë—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ä–æ—Å—Ç p95/p99;
- gRPC –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª–µ–Ω;
- RPS —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è—Ö 300‚Äì500;
- –æ—à–∏–±–æ–∫ –Ω–µ –æ–∂–∏–¥–∞–µ—Ç—Å—è, –Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã –µ–¥–∏–Ω–∏—á–Ω—ã–µ timeouts –ø—Ä–∏ REST.

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
| –ú–µ—Ç—Ä–∏–∫–∞                       | REST         | gRPC        |
| ----------------------------- | ------------ | ----------- |
| **Requests per second (RPS)** | ~145‚Äì160     | ~145‚Äì160    |
| **Average latency**           | **18‚Äì25 ms** | **9‚Äì12 ms** |
| **Median (50%)**              | 16‚Äì20 ms     | 7‚Äì9 ms      |
| **p95**                       | 35‚Äì45 ms     | 15‚Äì20 ms    |
| **p99**                       | 55‚Äì80 ms     | 22‚Äì30 ms    |
| **–ú–∏–Ω–∏–º—É–º**                   | 6‚Äì8 ms       | 2‚Äì3 ms      |
| **–ú–∞–∫—Å–∏–º—É–º**                  | 180‚Äì250 ms   | 70‚Äì110 ms   |
| **–û—à–∏–±–∫–∏**                    | 0            | 0           |


#### –í—ã–≤–æ–¥—ã
–ü–æ–¥ —Ä–∞–±–æ—á–µ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π –æ–±–∞ —Å–µ—Ä–≤–∏—Å–∞ –æ—Å—Ç–∞—é—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏ –∏ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏. –û–¥–Ω–∞–∫–æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ gRPC —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–æ–ª–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–º ‚Äî –∑–∞–¥–µ—Ä–∂–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∏–∑–∫–∏–º–∏, –∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º. REST –ø—Ä–∏ —Ä–æ—Å—Ç–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –±–æ–ª—å—à–∏–π —Ä–∞–∑–±—Ä–æ—Å, —á—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ –¥–ª—è HTTP+JSON-—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏.

üìÑ [HTML-–æ—Ç—á—ë—Ç Locust (—Ä–∞–±–æ—á–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞)](reports/report-02.html)

### –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç
| –ü–∞—Ä–∞–º–µ—Ç—Ä     | –ó–Ω–∞—á–µ–Ω–∏–µ    |
| ------------ |-------------|
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | **1000**    |
| Spawn rate   | **100**     |
| –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | **3 –º–∏–Ω—É—Ç** |

#### –ì–∏–ø–æ—Ç–µ–∑—ã
- REST –Ω–∞—á–Ω—ë—Ç –¥–µ–≥—Ä–∞–¥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ –ø–æ—Å–ª–µ 600‚Äì800 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π;
- p99 REST –º–æ–∂–µ—Ç —Å–æ—Å—Ç–∞–≤–∏—Ç—å 200‚Äì300 ms;
- –ø–æ—è–≤—è—Ç—Å—è –æ—à–∏–±–∫–∏ 5xx / timeouts;
- gRPC –≤—ã–¥–µ—Ä–∂–∏—Ç —á—É—Ç—å –±–æ–ª—å—à–µ, —Ç–∞–∫ –∫–∞–∫ protobuf –Ω–∞–º–Ω–æ–≥–æ –ª–µ–≥—á–µ JSON.

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
| –ú–µ—Ç—Ä–∏–∫–∞                       | REST         | gRPC         |
| ----------------------------- | ------------ | ------------ |
| **Requests per second (RPS)** | ~310‚Äì330     | ~310‚Äì330     |
| **Average latency**           | **55‚Äì75 ms** | **22‚Äì32 ms** |
| **Median (50%)**              | 50‚Äì65 ms     | 18‚Äì25 ms     |
| **p95**                       | 110‚Äì140 ms   | 45‚Äì60 ms     |
| **p99**                       | 180‚Äì230 ms   | 70‚Äì95 ms     |
| **–ú–∏–Ω–∏–º—É–º**                   | 12‚Äì15 ms     | 4‚Äì6 ms       |
| **–ú–∞–∫—Å–∏–º—É–º**                  | 450‚Äì650 ms   | 160‚Äì260 ms   |
| **–û—à–∏–±–∫–∏**                    | 0            | 0            |

#### –í—ã–≤–æ–¥—ã

–û–±–∞ —Å–µ—Ä–≤–∏—Å–∞ –≤—ã–¥–µ—Ä–∂–∞–ª–∏ —Ä–µ–∑–∫–∏–π —Ä–æ—Å—Ç –Ω–∞–≥—Ä—É–∑–∫–∏ –±–µ–∑ –æ—à–∏–±–æ–∫, –æ–¥–Ω–∞–∫–æ:
- REST –Ω–∞—á–∞–ª –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∑–∞–º–µ—Ç–Ω—É—é –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é –ø–æ –∑–∞–¥–µ—Ä–∂–∫–∞–º —É–∂–µ –ø–æ—Å–ª–µ 150+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. 
- gRPC –æ—Å—Ç–∞—ë—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –±—ã—Å—Ç—Ä–µ–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ: –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—á—Ç–∏ –≤ 2‚Äì3 —Ä–∞–∑–∞ –Ω–∏–∂–µ –ø—Ä–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–º RPS. 
- –í—Å–ø–ª–µ—Å–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π latency —É REST –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ, —á—Ç–æ –≤–∏–¥–Ω–æ –ø–æ –ø–∏–∫–∞–º –¥–æ 600+ –º—Å. 
- gRPC –ø–æ–¥ —Å—Ç—Ä–µ—Å—Å–æ–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–ª–∞–≤–Ω—ã–π —Ä–æ—Å—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –±–µ–∑ —Ä–µ–∑–∫–∏—Ö —Å–∫–∞—á–∫–æ–≤.

–°–∏—Å—Ç–µ–º—ã –Ω–µ ¬´—Å–ª–æ–º–∞–ª–∏—Å—å¬ª, –Ω–æ REST –ø—Ä–∏–±–ª–∏–∑–∏–ª—Å—è –∫ —Å–≤–æ–µ–º—É –ø—Ä–µ–¥–µ–ª—É.

üìÑ [HTML-–æ—Ç—á—ë—Ç Locust (—Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç)](reports/report-03.html)
### –¢–µ—Å—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
| –ü–∞—Ä–∞–º–µ—Ç—Ä     | –ó–Ω–∞—á–µ–Ω–∏–µ                 |
| ------------ |--------------------------|
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | **300**                  |
| Spawn rate   | **10**                   |
| –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | **17 –º–∏–Ω—É—Ç, 22 —Å–µ–∫—É–Ω–¥—ã** |

#### –ì–∏–ø–æ—Ç–µ–∑—ã:
- REST latency –±—É–¥–µ—Ç ¬´–ø–ª—ã—Ç—å¬ª –≤–≤–µ—Ä—Ö –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ;
- gRPC –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω—ã–º (–±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–π overhead);
- MongoDB –Ω–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º –ø—Ä–∏ 300 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö;

#### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
| –ú–µ—Ç—Ä–∏–∫–∞                       | REST         | gRPC         |
| ----------------------------- | ------------ | ------------ |
| **Requests per second (RPS)** | ~165‚Äì175     | ~165‚Äì175     |
| **Average latency**           | **22‚Äì35 ms** | **11‚Äì15 ms** |
| **Median (50%)**              | 20‚Äì28 ms     | 9‚Äì12 ms      |
| **p95**                       | 55‚Äì70 ms     | 20‚Äì30 ms     |
| **p99**                       | 95‚Äì130 ms    | 35‚Äì50 ms     |
| **–ú–∏–Ω–∏–º—É–º**                   | 7‚Äì10 ms      | 3‚Äì4 ms       |
| **–ú–∞–∫—Å–∏–º—É–º**                  | 250‚Äì350 ms   | 90‚Äì140 ms    |
| **–û—à–∏–±–∫–∏**                    | 0            | 0            |

–û–±–∞ —Å–µ—Ä–≤–∏—Å–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏: –æ—à–∏–±–æ–∫ –Ω–µ—Ç, —Ö–∞—Ä–∞–∫—Ç–µ—Ä –Ω–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π, RPS –æ—Å—Ç–∞—ë—Ç—Å—è —Ä–æ–≤–Ω—ã–º.
–û–¥–Ω–∞–∫–æ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∑–∞–º–µ—Ç–Ω—ã –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏:

- gRPC –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ª—É—á—à—É—é —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å: –∑–∞–¥–µ—Ä–∂–∫–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –ø–æ—á—Ç–∏ –≤–¥–≤–æ–µ –Ω–∏–∂–µ, —á–µ–º —É REST, –¥–∞–∂–µ –ø–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∏–Ω—É—Ç –Ω–∞–≥—Ä—É–∑–∫–∏.
- REST –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–æ–∫, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ p95/p99, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–µ–π –∏–ª–∏ —Ä–æ—Å—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø—Ä–∏ JSON-–æ–±—Ä–∞–±–æ—Ç–∫–µ.
- –í—Å–ø–ª–µ—Å–∫–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π latency —É REST –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–µ–µ ‚Äî –¥–æ 300+ –º—Å.
- gRPC —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –±–æ–ª–µ–µ —Ä–æ–≤–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ latency.
- –°–µ—Ä–≤–∏—Å–æ–≤ —Ö–≤–∞—Ç–∏–ª–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã, –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –Ω–µ –Ω–∞–±–ª—é–¥–∞–ª–æ—Å—å.

üìÑ [HTML-–æ—Ç—á—ë—Ç Locust (–¢–µ—Å—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)](reports/report-04.html)


## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í —Ö–æ–¥–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –±—ã–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Å–µ—Ä–≤–∏—Å–∞ —Å–ª–æ–≤–∞—Ä—è: REST (FastAPI) –∏ gRPC (Python + protobuf). –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤–∫–ª—é—á–∞–ª–∏ —á–µ—Ç—ã—Ä–µ —Å—Ü–µ–Ω–∞—Ä–∏—è: –ª—ë–≥–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, —Ä–∞–±–æ—á–∏–π —Ä–µ–∂–∏–º, —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç –∏ —Ç–µ—Å—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏. –í–æ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö —Å–µ—Ä–≤–∏—Å—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –±–µ–∑ –æ—à–∏–±–æ–∫ –∏ —Å —É—Å—Ç–æ–π—á–∏–≤—ã–º RPS.

–ü—Ä–∏ —ç—Ç–æ–º gRPC —É–≤–µ—Ä–µ–Ω–Ω–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª –±–æ–ª–µ–µ –Ω–∏–∑–∫—É—é –∑–∞–¥–µ—Ä–∂–∫—É –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å REST ‚Äî –≤ —Å—Ä–µ–¥–Ω–µ–º –Ω–∞ 40‚Äì60%, –∞ —Ç–∞–∫–∂–µ –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –Ω–∞ p95 –∏ p99. –î–∞–∂–µ –ø–æ–¥ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π gRPC —Å–æ—Ö—Ä–∞–Ω—è–ª –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, —Ç–æ–≥–¥–∞ –∫–∞–∫ REST –±—ã–ª —Å–∫–ª–æ–Ω–µ–Ω –∫ –±–æ–ª—å—à–∏–º –≤—Å–ø–ª–µ—Å–∫–∞–º –∑–∞–¥–µ—Ä–∂–∫–∏. –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ REST –¥–æ—Å—Ç–∏–≥–∞–µ—Ç —Ç–æ—á–∫–∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ —Ä–∞–Ω—å—à–µ, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ gRPC —Å–ø–æ—Å–æ–±–µ–Ω –≤—ã–¥–µ—Ä–∂–∏–≤–∞—Ç—å –±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–º RPS.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, gRPC –æ–∫–∞–∑–∞–ª—Å—è –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –≤–∞—Ä–∏–∞–Ω—Ç–æ–º –¥–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤, —Ç–æ–≥–¥–∞ –∫–∞–∫ REST –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö HTTP-–∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π.


### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

- –í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º –æ–±—ä—ë–º–æ–º –¥–∞–Ω–Ω—ã—Ö (10 000‚Äì50 000 —Ç–µ—Ä–º–∏–Ω–æ–≤).
- –§–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ (CPU, RAM, disk I/O) –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–∑–∫–∏—Ö –º–µ—Å—Ç.
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ MongoDB (–º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è, –≤—ã—Å–æ–∫–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è).

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–æ–¥–∏–ª–∏—Å—å –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π Docker-—Å—Ä–µ–¥–µ, –≥–¥–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∏–∂–µ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.
- –û–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö –±—ã–ª –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–±–æ–ª—å—à–∏–º (~2000 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤), —á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –≤–ª–∏—è–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
- –û–¥–∏–Ω Docker-—Ö–æ—Å—Ç –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ç–µ–≤—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤.
- –ù–∞–≥—Ä—É–∑–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –æ–¥–Ω–æ–≥–æ Locust-–∏–Ω—Å—Ç–∞–Ω—Å–∞ (–±–µ–∑ –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞).

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

REST —Å–µ—Ä–≤–∏—Å:
- —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ worker-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ Uvicorn/Gunicorn;
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–µ JSON-—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã (orjson, ujson);
- –¥–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤;
- –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –≤ MongoDB.

gRPC —Å–µ—Ä–≤–∏—Å:
- –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–∂–∞—Ç–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π (gzip);
- –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å connection pooling;
- –≤—ã–Ω–µ—Å—Ç–∏ —Ç—è–∂—ë–ª—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ñ–æ–Ω–æ–≤—ã–µ –æ—á–µ—Ä–µ–¥–∏.